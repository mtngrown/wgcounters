#! /usr/bin/env ruby
# frozen_string_literal: true

require 'nokogiri'
require_relative 'counter'
require_relative 'us_background'

class Blackhorse < Counter
  include UsBackground

  # Black outer shield
  PATH_OUTER = 'm 232.56133,198.78711 c 2.78368,-20.32072 1.27007,-42.00242 2.07259,-62.35859 C 234.64292,90.952348 234.65112,45.476174 234.65972,0 156.58769,0.1583377 78.515692,0.3341163 0.44375093,0.5318493 0.56269903,66.24477 -0.54095777,132.03002 0.35104983,197.69769 10.890192,246.82617 69.091333,291.13501 115.15976,305.097 162.35303,286.32584 224.29401,254.69188 232.56133,198.78711 z'

  # White inner shield
  PATH_WHITE = 'm 227.25819,196.51158 c 2.65557,-19.32068 1.21161,-39.93536 1.9772,-59.28976 0.008,-43.238158 0.0164,-86.476326 0.0246,-129.7144947 C 154.78096,7.6578713 80.301976,7.8249993 5.8230377,8.0130013 5.9365117,70.492011 4.8836477,133.0398 5.7346077,195.47578 15.78872,242.18651 71.311346,284.3148 115.25962,297.58967 160.28098,279.74229 219.37133,249.66512 227.25818,196.51158 z'

  # Red diagonal stripe
  PATH_RED = 'M 5.8242167,8.0130003 C 5.9514597,68.890852 4.9254637,134.22025 5.7337367,195.23975 l 0.301615,1.57487 C 10.18153,214.52328 20.825954,231.52411 34.809495,246.5136 L 229.26265,7.5025243 C 154.78313,7.6264553 80.30364,7.8259163 5.8242167,8.0130003 z'

  # Black details
  PATH_DETAILS = 'm 117.36903,280.92198 c 0.49053,-3.83189 0.89034,-6.12586 2.90804,-7.10694 0.16407,-0.89314 0.35812,-1.14853 0.35537,-2.51164 5.8075,-7.34052 28.41312,-25.79901 32.35942,-34.23201 -0.89542,-2.11364 -4.99126,-4.25983 -6.65852,-4.4458 -0.24068,0.89953 0.35423,2.2757 0.0564,3.57577 -1.08282,0.62962 -1.6297,1.63139 -2.88454,2.20844 -12.54923,5.77092 -32.08125,9.6583 -38.88336,18.97787 -0.84049,0.5591 -0.54637,0.52591 -1.7488,0.6232 -0.44317,1.94515 -0.13842,2.99629 -0.25423,4.34273 -3.081731,0.44734 -7.155321,1.21445 -10.967833,0.80921 -0.200112,-8.34129 3.806272,-3.80633 7.196402,-14.08953 11.724621,-4.8486 30.682521,-13.2848 36.547551,-25.19512 -0.0864,-3.13226 -0.61808,-6.33794 -1.16093,-9.75446 -3.73641,-5.29132 -5.78555,-13.99757 -7.11671,-20.36727 -4.36505,-6.41168 -8.44137,-13.76383 -14.03208,-20.47426 -15.118411,-13.83006 -23.906919,-29.70364 -33.236229,-47.16112 -7.387382,0.64431 -12.954594,3.69004 -22.11624,5.2599 -12.281262,3.55995 -23.032689,9.9809 -34.549373,16.24623 -1.71462,1.2283 -0.812477,4.84471 -1.356399,5.35153 -2.883715,1.74789 -6.456113,3.23572 -10.192749,3.30071 0.02575,-2.05477 -0.56145,-9.11958 1.544036,-11.0137 1.971432,-0.30829 1.258554,-1.9544 1.846538,-2.81311 4.984491,-1.28305 6.157045,-1.42329 11.71621,-5.17633 19.451453,-8.54711 34.036605,-22.65101 42.734577,-27.2701 l 0.654808,-9.34886 c -1.349852,-0.6211 -1.792094,-3.353486 -2.106687,-5.884976 -0.281936,-2.268545 -3.123441,-8.656145 -4.348653,-11.791359 -2.054502,-1.410256 -5.8278,-2.493273 -7.725398,-1.649197 -1.897598,0.844076 -7.414376,4.736977 -12.284699,10.117349 -1.072207,1.527841 -2.70301,0.744286 -3.966979,3.947337 -0.5254,2.53121 1.518561,3.03609 1.303502,5.637126 -1.701664,0.73515 -1.171043,7.11016 -6.154256,9.2351 -2.262201,-6.51153 -3.318092,-8.41384 -3.132973,-11.113636 2.39012,-2.21462 2.895574,-3.12996 1.833101,-10.728701 7.978201,-4.78738 18.872326,-13.426952 20.446606,-16.823665 1.313948,-2.835011 6.154189,-4.677495 10.49554,-0.659646 3.508339,4.543037 14.843433,8.980457 18.495639,11.617005 2.256457,-1.474708 1.721542,-1.058043 4.577413,-1.914308 1.500607,-8.848588 9.177004,-16.889613 15.713285,-20.921478 0.42972,-1.477961 -0.29628,-3.504709 -1.64255,-3.896563 -4.735181,0.958767 -10.333326,-1.394933 -12.492873,-3.360096 -2.82682,0.195099 -6.065536,1.425167 -8.406218,3.078684 -0.333126,0.235328 0.188634,1.032767 -0.480497,1.58091 -0.872833,0.874226 -1.44047,1.398253 -3.263064,1.113062 -1.414838,-0.221388 -2.821442,-0.401987 -5.629454,-1.031536 -1.104759,-0.247684 -1.863264,-0.754314 -1.963916,-1.13768 -0.881336,-3.356835 -2.656371,-2.364171 -3.108943,-5.028656 -0.150712,-1.136535 -1.322204,-2.343285 -1.068441,-3.982865 0.123856,-0.800241 0.856769,-1.153504 1.459591,-1.921425 -0.45413,-1.076323 -0.508869,-2.963909 0.277035,-3.453354 0.957966,-0.124899 2.507263,-0.06962 4.003222,-1.113535 5.393835,-3.763951 10.769636,-9.325651 17.543179,-15.199064 4.554384,-6.697636 10.764608,-6.517682 12.826359,-10.57698 1.60627,-0.07686 6.21069,-0.21143 10.1449,-0.143112 0.40584,0.0066 0.18092,-0.569818 -0.11521,-0.702112 0.60753,0.146287 1.05088,0.643139 1.1896,0.743483 2.42908,0.601806 6.7542,0.481901 5.62084,-1.087819 1.0127,0.624461 1.15483,1.291179 1.47718,2.904507 2.87109,1.350554 8.25744,2.618184 8.5564,1.818636 1.00685,0.840946 1.43764,2.695252 1.48885,3.586811 1.13855,0.395681 3.5644,-1.056928 4.62197,-2.277396 2.03076,0.780809 2.74675,9.024412 4.29049,11.605282 1.36798,0.642037 2.9014,-0.208789 3.22711,-1.219378 2.52935,4.868908 4.2496,17.350257 3.39039,21.37744 0.87934,1.359173 2.46375,1.23019 3.15922,0.228962 1.34765,3.927475 1.10691,7.912517 1.11529,10.303473 0.84059,0.998431 1.94545,1.092666 2.64202,0.366789 0.19594,10.429156 -8.49309,25.707075 -14.42071,34.134305 -0.22738,6.239866 0.72534,14.891836 2.81284,20.158416 7.01499,17.69814 14.96068,23.96447 28.24643,37.89247 6.2559,1.09016 14.035,10.25173 16.00376,15.75751 l 2.86019,0.10139 c 2.45357,-5.5565 5.58876,-5.57627 13.91565,-4.19962 8.31343,1.37443 7.13217,13.87015 10.30215,12.81237 -0.26468,0.84499 -1.19201,1.16333 -1.76357,1.00056 1.47917,4.84273 -1.37967,18.76042 -4.2258,23.44184 -4.10152,6.74633 -11.34957,11.78535 -10.12962,15.86852 1.22499,4.10006 6.85019,3.51111 7.09028,-0.57709 1.77118,0.94048 1.74052,6.02808 -0.54659,9.52592 -0.21309,0.32589 -0.21356,2.02577 1.16002,0.82601 -0.75369,1.97112 -3.22834,4.52053 -6.86776,5.87674 -9.95791,3.71077 -18.85022,-1.47431 -21.65963,-10.69661 -2.82697,-9.27996 6.69955,-23.92401 15.23706,-26.32897 3.0084,-2.12611 1.08169,-5.76382 0.70292,-11.63706 -2.33086,-1.63448 -6.7003,0.48841 -7.16472,1.63974 1.89162,10.27524 -6.89215,20.82736 -14.66845,27.20944 -5.34043,1.85542 -3.3375,9.15837 -2.43048,9.54243 4.5166,1.9125 4.8184,9.76467 1.85289,14.54193 -0.7999,0.78855 -3.62917,2.14984 -4.53183,2.8586 -11.67551,9.16752 -24.46363,18.36483 -33.39039,30.01777 -0.95539,1.92828 -1.48814,1.61078 -2.34921,2.99678 -0.15405,1.53882 -0.14904,3.28716 -0.49184,5.83483 -4.66552,0.50648 -7.78359,0.16239 -10.31287,0.023 z'

  def blackhorse_insignia(xml)
    xml.path(d: PATH_OUTER, fill: '#000000', style: 'fill-opacity:1;stroke:none')
    xml.path(d: PATH_WHITE, fill: '#ffffff', style: 'fill-opacity:1;stroke:none')
    xml.path(d: PATH_RED, fill: '#9f0f0f', style: 'fill-opacity:1;stroke:none')
    xml.path(d: PATH_DETAILS, fill: '#000000', style: 'fill-opacity:1;stroke:none')
  end

  def build_counter(xml)
    counter_background(xml)
    xml.g(transform: "translate(#{offset_x},#{offset_y})") do
      bounding_box(xml)
    end
    xml.g(transform: 'translate(277,207) scale(2.0)') do
      blackhorse_insignia(xml)
    end
  end

  def to_svg
    builder = Nokogiri::XML::Builder.new do |xml|
      xml.svg(xmlns: 'http://www.w3.org/2000/svg', width: counter_width, height: counter_height) do
        build_counter(xml)
      end
    end
    builder.to_xml
  end
end

File.write('generated/blackhorse-counter.svg', Blackhorse.new.to_svg)
